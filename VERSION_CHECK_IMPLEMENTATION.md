# ğŸ”„ å¼·åˆ¶ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ©Ÿèƒ½ - å®Ÿè£…å®Œäº†å ±å‘Š

## ğŸ“Œ å®Ÿè£…æ¦‚è¦

GYM MATCHã‚¢ãƒ—ãƒªã«**ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ãƒ»å¼·åˆ¶ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ©Ÿèƒ½**ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

---

## âœ… å®Ÿè£…å†…å®¹

### 1. ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ã‚µãƒ¼ãƒ“ã‚¹ (`lib/services/version_check_service.dart`)

**æ©Ÿèƒ½**:
- Firestoreã‹ã‚‰æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’å–å¾—
- ç¾åœ¨ã®ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨æ¯”è¼ƒ
- æ›´æ–°ãŒå¿…è¦ã‹ã©ã†ã‹ã‚’åˆ¤å®šï¼ˆä»»æ„ or å¼·åˆ¶ï¼‰

**ãƒ­ã‚¸ãƒƒã‚¯**:
```dart
// ä»»æ„æ›´æ–°: ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ >= minimum && < recommended
// å¼·åˆ¶æ›´æ–°: ç¾åœ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ < minimum
```

**ä¾å­˜é–¢ä¿‚**:
- `package_info_plus`: ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—
- `cloud_firestore`: ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±å–å¾—

---

### 2. æ›´æ–°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°UI (`lib/widgets/update_dialog.dart`)

**æ©Ÿèƒ½**:
- ä»»æ„æ›´æ–°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆã€Œå¾Œã§ã€ãƒœã‚¿ãƒ³ã‚ã‚Šï¼‰
- å¼·åˆ¶æ›´æ–°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆã€Œä»Šã™ãæ›´æ–°ã€ã®ã¿ï¼‰
- App Store URLã¸ã®é·ç§»

**ãƒ‡ã‚¶ã‚¤ãƒ³**:
- Material Design 3æº–æ‹ 
- ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯
- ã‚¢ã‚¤ã‚³ãƒ³ + ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º

---

### 3. ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ã‚¹ã‚¯ãƒªãƒ¼ãƒ³çµ±åˆ (`lib/screens/splash_screen.dart`)

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
```
ã‚¢ãƒ—ãƒªèµ·å‹•
  â†“
ã‚¹ãƒ—ãƒ©ãƒƒã‚·ãƒ¥ç”»é¢ï¼ˆ2ç§’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
  â†“
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯
  â†“
â”œâ”€ æ›´æ–°å¿…è¦ â†’ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
â”‚   â”œâ”€ ä»»æ„æ›´æ–° â†’ ã€Œå¾Œã§ã€ã§ç¶™ç¶šå¯èƒ½
â”‚   â””â”€ å¼·åˆ¶æ›´æ–° â†’ ã‚¢ãƒ—ãƒªèµ·å‹•åœæ­¢
â”‚
â””â”€ æ›´æ–°ä¸è¦ â†’ ã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚° or ãƒ›ãƒ¼ãƒ ç”»é¢
```

**çµ±åˆç®‡æ‰€**: 58-73è¡Œç›®

---

### 4. Firestoreè¨­å®š

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‘ã‚¹**: `app_config/version_control`

**å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**:
```json
{
  "minimum_version": "1.0.100",
  "recommended_version": "1.0.112",
  "update_message": "æ–°æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼",
  "store_url_ios": "https://apps.apple.com/...",
  "store_url_android": "https://play.google.com/..."
}
```

**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«** (`firestore.rules`):
```javascript
match /app_config/version_control {
  allow read: if true;  // å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼èª­ã¿å–ã‚Šå¯
  allow write: if false; // ç®¡ç†è€…ã®ã¿ï¼ˆFirebaseã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼‰
}
```

---

### 5. ä¾å­˜é–¢ä¿‚è¿½åŠ  (`pubspec.yaml`)

```yaml
dependencies:
  package_info_plus: ^8.1.2  # ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—
  url_launcher: ^6.3.1       # ã‚¹ãƒˆã‚¢URLã‚ªãƒ¼ãƒ—ãƒ³ï¼ˆæ—¢å­˜ï¼‰
```

---

## ğŸ“Š å®Ÿè£…çµ±è¨ˆ

| é …ç›® | è©³ç´° |
|------|------|
| **æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«** | 3ãƒ•ã‚¡ã‚¤ãƒ« |
| **ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«** | 2ãƒ•ã‚¡ã‚¤ãƒ« |
| **è¿½åŠ ã‚³ãƒ¼ãƒ‰è¡Œæ•°** | ~450è¡Œ |
| **æ‰€è¦æ™‚é–“** | ç´„20åˆ† |

---

## ğŸ¯ å‹•ä½œã‚·ãƒŠãƒªã‚ª

### ã‚·ãƒŠãƒªã‚ª1: æœ€æ–°ç‰ˆï¼ˆv1.0.112ï¼‰
- **çµæœ**: ãƒ€ã‚¤ã‚¢ãƒ­ã‚°éè¡¨ç¤ºã€é€šå¸¸èµ·å‹•
- **ç†ç”±**: `current >= recommended`

### ã‚·ãƒŠãƒªã‚ª2: æ¨å¥¨æœªæº€ï¼ˆv1.0.110ï¼‰
- **çµæœ**: ä»»æ„æ›´æ–°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
- **å‹•ä½œ**: ã€Œå¾Œã§ã€ãƒœã‚¿ãƒ³ã§ã‚¹ã‚­ãƒƒãƒ—å¯èƒ½
- **ç†ç”±**: `current >= minimum && current < recommended`

### ã‚·ãƒŠãƒªã‚ª3: æœ€ä½ç‰ˆæœªæº€ï¼ˆv1.0.99ï¼‰
- **çµæœ**: å¼·åˆ¶æ›´æ–°ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
- **å‹•ä½œ**: ã€Œä»Šã™ãæ›´æ–°ã€ã®ã¿ã€ã‚¹ã‚­ãƒƒãƒ—ä¸å¯
- **ç†ç”±**: `current < minimum`

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: Firestoreè¨­å®š

1. Firebase Console â†’ Firestore Database
2. ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ `app_config` ã‚’ä½œæˆ
3. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ `version_control` ã‚’ä½œæˆ
4. ä¸Šè¨˜ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¨­å®š

### ã‚¹ãƒ†ãƒƒãƒ—2: ä»»æ„æ›´æ–°ãƒ†ã‚¹ãƒˆ

```json
{
  "minimum_version": "1.0.100",
  "recommended_version": "1.0.113"
}
```

- v1.0.112ã®ã‚¢ãƒ—ãƒªã‚’èµ·å‹•
- ã€Œå¾Œã§ã€ãƒœã‚¿ãƒ³ã§ã‚¹ã‚­ãƒƒãƒ—å¯èƒ½ã‚’ç¢ºèª

### ã‚¹ãƒ†ãƒƒãƒ—3: å¼·åˆ¶æ›´æ–°ãƒ†ã‚¹ãƒˆ

```json
{
  "minimum_version": "1.0.113",
  "recommended_version": "1.0.113"
}
```

- v1.0.112ã®ã‚¢ãƒ—ãƒªã‚’èµ·å‹•
- ã‚¹ã‚­ãƒƒãƒ—ä¸å¯ã€App Storeé·ç§»ã®ã¿ã‚’ç¢ºèª

---

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### 1. Firebaseã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã®ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
cd /home/user/webapp
firebase deploy --only firestore:rules
```

### 2. FirestoreåˆæœŸè¨­å®š

æ‰‹å‹•ã§ `app_config/version_control` ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆ
ï¼ˆè©³ç´°ã¯ `firestore_setup_version_control.md` ã‚’å‚ç…§ï¼‰

### 3. ã‚¢ãƒ—ãƒªãƒ“ãƒ«ãƒ‰ï¼†ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# TestFlightãƒ“ãƒ«ãƒ‰ï¼ˆGitHub Actionsï¼‰
git tag v1.0.113
git push origin v1.0.113

# ã¾ãŸã¯æ‰‹å‹•ãƒ“ãƒ«ãƒ‰
flutter build ipa --release
```

---

## ğŸ“ˆ æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

### 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®å‘ä¸Š
- âœ… æœ€æ–°æ©Ÿèƒ½ã‚’å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æä¾›
- âœ… ãƒã‚°ä¿®æ­£ã‚’å³åº§ã«åæ˜ 

### 2. ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã®å¾¹åº•
- âœ… v1.0.112ä»¥é™ã®Google Maps APIæœ€é©åŒ–ï¼ˆå¹´é–“Â¥48,564å‰Šæ¸›/1000ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰ã‚’å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é©ç”¨
- âœ… å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã‚‹APIã‚¯ã‚©ãƒ¼ã‚¿ç„¡é§„é£ã„ã‚’é˜²æ­¢

### 3. é‹ç”¨åŠ¹ç‡ã®å‘ä¸Š
- âœ… è¤‡æ•°ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¯¾å¿œã®è² æ‹…è»½æ¸›
- âœ… ã‚µãƒãƒ¼ãƒˆã‚³ã‚¹ãƒˆã®å‰Šæ¸›

---

## âš ï¸ æ³¨æ„äº‹é …

1. **`minimum_version`ã®è¨­å®šã¯æ…é‡ã«**
   - å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¨å“¡ã‚¢ãƒ—ãƒªã‚’ä½¿ãˆãªããªã‚Šã¾ã™
   - é‡å¤§ãªãƒã‚°ã‚„äº’æ›æ€§å•é¡ŒãŒã‚ã‚‹å ´åˆã®ã¿ä½¿ç”¨

2. **App Storeå¯©æŸ»ã¸ã®å½±éŸ¿**
   - å¼·åˆ¶æ›´æ–°æ©Ÿèƒ½ã¯å¯©æŸ»å¯¾è±¡å¤–ï¼ˆã‚µãƒ¼ãƒãƒ¼å´ã§ç®¡ç†ï¼‰
   - ãƒ€ã‚¤ã‚¢ãƒ­ã‚°UIã¯å¯©æŸ»æ™‚ã«è¡¨ç¤ºã•ã‚Œãªã„ï¼ˆFirestoreæœªè¨­å®šæ™‚ï¼‰

3. **æ®µéšçš„ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ**
   - åˆæœŸã¯ `minimum_version` ã‚’ä½ã‚ã«è¨­å®š
   - å‹•ä½œç¢ºèªå¾Œã€å¾ã€…ã«å¼•ãä¸Šã’

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Firestoreè¨­å®šæ‰‹é †](./firestore_setup_version_control.md)
- [Firestoreã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«](./firestore.rules)

---

## ğŸ“ å®Ÿè£…è€…æƒ…å ±

- **å®Ÿè£…æ—¥**: 2025-12-04
- **å®Ÿè£…è€…**: AI Assistant (Claude)
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.0.113ï¼ˆäºˆå®šï¼‰
- **ãƒ¬ãƒ“ãƒ¥ãƒ¼**: æœªå®Ÿæ–½ï¼ˆæ¬¡å›å¯¾å¿œï¼‰

---

## ğŸ‰ å®Ÿè£…å®Œäº†ï¼

ã“ã®æ©Ÿèƒ½ã«ã‚ˆã‚Šã€GYM MATCHã‚¢ãƒ—ãƒªã¯å¸¸ã«æœ€æ–°ã®çŠ¶æ…‹ã‚’ç¶­æŒã—ã€
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æœ€é«˜ã®ä½“é¨“ã‚’æä¾›ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:
1. âœ… Firestoreè¨­å®š
2. âœ… TestFlight v1.0.113ãƒ‡ãƒ—ãƒ­ã‚¤
3. âœ… ãƒ†ã‚¹ãƒˆå®Ÿæ–½
4. âœ… App Storeæå‡º
