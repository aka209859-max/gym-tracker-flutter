# GYM MATCH v1.03 機能一覧

**バージョン**: v1.03 (Build 183)  
**プラットフォーム**: iOS 15.0+  
**App Store**: https://apps.apple.com/jp/app/gym-match/id6755346813

---

## 📱 4つのコア機能

### 1️⃣ トレーニング記録管理
- 詳細記録（種目・重量・回数・セット数・RPE・メモ）
- カレンダービュー（月間トレーニング日の視覚化）
- 統計ダッシュボード（7日間/今月/全期間の総挙上重量）
- **腹筋の回数/秒数モード切替**（v1.0.169+）
  - プランク → 秒数モード
  - クランチ → 回数モード
  - ユーザーが自由に切り替え可能
- **オフライン記録対応**（v1.0.161+）
  - ネットワーク不要でトレーニング記録
  - オンライン復帰時に自動同期
- **オフ日（休息日）管理**（v1.0.178+）
  - カレンダーに緑色で「オフ」と表示
- テンプレート機能（よく行うメニューを保存）
- CSV インポート機能（他アプリからのデータ移行）
- ワークアウトメモ機能
- 部位別トラッキング
- ジム訪問履歴

### 2️⃣ AI トレーニングコーチング
- **Google Gemini 2.5 Flash** による部位別メニュー自動生成
  - 胸・背中・脚・肩・腕・腹筋・有酸素
- レベル別カスタマイズ
  - 初心者モード: フォーム重視
  - 中級者モード: ボリューム重視
  - 上級者モード: 高強度
- **AI 成長予測**（Premium以上）
  - 1RM予測（理論的最大挙上重量）
  - 成長曲線予測
  - 個人要因補正（年齢・経験・睡眠・栄養・飲酒）
- **週次レポート自動生成**（Premium以上）
  - 週間総挙上重量分析
  - 部位別トレーニング量分析
  - AI による改善提案
- **疲労管理システム**
  - トレーニング量から疲労度を自動計算
  - 部位別疲労度の可視化
  - オーバートレーニング警告

**AI使用回数:**
- 無料: 広告視聴で月3回
- Premium: 月10回
- Pro: 無制限

### 3️⃣ ジム検索・混雑度表示
- **GPS位置検索** + Google Maps 連携
- **リアルタイム混雑度表示**（5段階）
  - 空いている 🟢 → やや混雑 🟡 → 混雑 🟠 → 非常に混雑 🔴
  - ユーザーレポート（24時間有効）を最優先
  - 統計データから推定混雑度算出
- ジム詳細情報
  - 営業時間・定休日・電話番号・住所
  - 設備情報（フリーウェイト・マシン・有酸素・シャワー等）
  - 写真ギャラリー
  - Google Maps 連携（ルート検索ワンタップ）
- **混雑度レポート投稿**（全ユーザー）
- **ジムレビュー投稿**（Premium以上）
  - 5段階評価 + コメント
- **お気に入り登録**（Premium以上）
  - よく行くジムをブックマーク
  - 無制限保存
- ジム検索（キーワード・エリア・設備・営業時間）
- **コスト最適化**（v1.0.149+）
  - Hiveキャッシュ導入で年間¥48,564削減/1000ユーザー

### 4️⃣ トレーニングパートナーマッチング（Proプラン限定）
- **Skill-based Matching**
  - BIG3（ベンチプレス・スクワット・デッドリフト）の1RMで ±15% 以内
- **時空間コンテキストマッチング**
  - 同じジムをお気に入り登録
  - 同じ曜日・時間帯（±2時間）に活動
- パートナー検索
  - 距離・目標・経験レベル・性別・年齢・曜日・時間帯でフィルター
- メッセージング機能（1対1チャット）
- フレンドリクエスト（送信・受信・承認・拒否）

---

## 📊 その他の主要機能

### ⚖️ 体重・体組成管理
- 体重・体脂肪率・除脂肪体重記録
- 体重推移グラフ（v1.0.158+）
  - 期間切り替え（1週間・1ヶ月・3ヶ月・全期間）
- 体重記録削除機能（v1.0.159+）

### 🏅 パーソナルレコード（PR）管理
- **自動PR更新**（トレーニング記録時に最大重量を自動判定）
- 種目別PR一覧
- PR達成日記録
- **懸垂の体重2重加算バグ修正**（v1.0.175）
  - 93kg → 186kg → 279kg と加算されるバグを完全修正
  - `additional_weight` フィールド導入で正確な記録

### 🎯 目標設定・達成バッジ
- 目標設定（体重目標・種目別目標・期限管理）
- 達成バッジシステム
  - 継続バッジ（連続記録日数）
  - ボリュームバッジ（総挙上重量）
  - PR達成バッジ（自己記録更新）
  - 種目別バッジ

### 🧮 計算ツール（全プラン共通）
- **1RM計算機**
  - Epley・Brzycki・Lander公式対応
  - %1RM逆算
- **プレート計算機**
  - 目標重量から必要なプレート枚数を自動計算
  - バーベル重量（20kg/15kg）を考慮
- **体組成計算機**
  - BMI・体脂肪率・除脂肪体重算出
- **カロリー計算機**
  - TDEE計算（1日消費カロリー）
  - 目標別推奨カロリー（減量・維持・増量）

### 📤 SNSシェア機能
- トレーニング記録シェア
  - Twitter・Instagram・LINE等に共有
  - カスタムデザイン・ハッシュタグ自動付与

### 🎟️ 紹介プログラム
- 招待コード入力機能
- 紹介報酬（AI使用回数追加）

### 📊 開発者・分析機能
- **Firebase Analytics**（v1.0.164+）
  - ユーザー行動トラッキング
  - スクリーン遷移分析
  - パフォーマンスモニタリング
- デバッグログ表示
- 開発者メニュー

---

## 💰 料金プラン

| プラン | 価格 | AI使用回数 | 主要機能 |
|--------|------|------------|----------|
| **無料** | ¥0 | 月3回（広告視聴） | トレーニング記録、カレンダー、統計、腹筋機能、オフライン記録、オフ日管理、計算ツール、ジム検索、混雑度表示、混雑度レポート投稿 |
| **Premium** | ¥500/月<br>¥4,800/年 | 月10回 | 無料の全機能 + AI成長予測、週次レポート、お気に入り無制限、ジムレビュー投稿、広告なし |
| **Pro** | ¥980/月<br>¥8,000/年 | 無制限 | Premiumの全機能 + パートナー検索、メッセージング |
| **AI追加パック** | ¥300/5回 | +5回 | 全ユーザー対象（今月末まで有効） |

---

## 🔄 v1.03の主要アップデート（Build 149-183）

### ⚡ 基盤強化（v1.0.149-157）
- 強制アップデート機能実装
- **Google Maps API コスト最適化**
  - Hiveキャッシュ導入（検索結果24時間、Place Details 30日間）
  - **年間¥48,564削減/1000ユーザー**
- **Google Gemini 2.5 Flash** へアップグレード（v1.0.157）
- お気に入り機能のバグ修正（v1.0.153-156）
- Null Safety 修正

### 💪 トレーニング記録強化（v1.0.158-164）
- **懸垂の体重自動反映**（v1.0.158）
- 体重記録削除機能（v1.0.159）
- **グラフ機能実装**（v1.0.158, 160）
  - 体重推移グラフ
  - 部位別トレーニング量グラフ
  - グラフUI大幅改善
- **オフライン記録機能**（v1.0.161-163, 177, 180）
  - ネットワーク不要でトレーニング記録可能
  - オンライン復帰時に自動同期
  - `connectivity_plus` パッケージ統合
  - `connectivity_plus` API変更対応（v1.0.180）
- 休憩タイマーのブラックアウトバグ修正（v1.0.162）
- **Firebase Analytics 完全実装**（v1.0.164）

### 🎯 腹筋機能完全対応（v1.0.165-173）
- 腹筋カテゴリ新設（v1.0.165）
- 体幹カテゴリを腹筋に統一（v1.0.166）
- 腹筋記録UI改善（v1.0.167）
- **回数/秒数モード切替機能**（v1.0.169）
  - プランク系: デフォルト「秒数」
  - クランチ系: デフォルト「回数」
  - `is_time_mode` フラグのFirestore保存
- ホーム画面での腹筋表示修正（v1.0.170-173）
- 腹筋自重表示修正（v1.0.171, 173）

### 🌐 日本語対応（v1.0.174）
- **App Store 日本語ローカライゼーション**
  - Xcodeプロジェクトに日本語ロケール追加
  - App Store審査で日本語アプリとして認識

### 🐛 重要バグ修正（v1.0.175-178）
- **懸垂の体重2重加算バグ修正**（v1.0.175）★CRITICAL
  - 症状: 93kg → 186kg → 279kg と加算され続ける
  - 修正: `additional_weight` フィールド導入で根本解決
- **秒数モード自動引き継ぎ**（v1.0.176）
  - ホーム画面の「＋」ボタンから追加時、前回の秒数モードを自動継承
- オフラインモード改善（v1.0.177）
  - ネットワーク検出ロジック精度向上
- **オフ日機能実装**（v1.0.178）
  - カレンダーに緑色で「オフ」と表示
  - 休息日の記録・管理

### 🔧 ビルドエラー修正（v1.0.179-183）
- home_screen.dart 構文エラー修正（v1.0.179）
  - `InkWell`、`Container`、`Row`、`Builder` の構文エラー
- **connectivity_plus API 対応**（v1.0.180）
  - `connectivity_plus ^6.1.2` の API 変更対応
  - `ConnectivityResult` → `List<ConnectivityResult>` 型変更
- 秒数表示の残存バグ修正（v1.0.181）
  - 「今日のトレーニング」リスト
  - 「前回記録」表示
- **テーブルヘッダー動的化**（v1.0.182）
  - ヘッダーを「秒数」or「回数」に動的切替
  - v1.0.169以前の古いデータ対応（`_getDefaultTimeMode` で種目名から自動判定）
- 欠落関数追加（v1.0.183）
  - `_getDefaultTimeMode` 関数を home_screen.dart に追加

---

## 📱 実装状況

### 画面数: 83画面
**主要カテゴリ:**
- ホーム/記録: 16画面
- AI機能: 7画面
- ジムマップ: 7画面
- パートナー: 8画面
- プロフィール/設定: 9画面
- 計算/目標: 5画面
- 課金: 4画面
- 開発者/管理: 10画面
- その他: 17画面

### サービス数: 57サービス
**主要サービス:**
- トレーニング記録関連: 8サービス
- AI機能: 8サービス
- ジム検索/混雑度: 7サービス
- パートナーマッチング: 6サービス
- 課金/広告: 7サービス
- その他: 21サービス

---

## 💻 技術スタック

### フロントエンド
- **Flutter**: 3.35.4
- **Dart**: 3.5.0+
- **状態管理**: Provider 6.1.5

### バックエンド
- **Firebase Firestore**: メインデータストア（22コレクション）
- **Firebase Authentication**: 匿名ログイン
- **Firebase Storage**: 画像保存
- **Firebase Analytics**: ユーザー行動トラッキング（v1.0.164+）
- **Hive**: オフラインキャッシュ（v1.0.149+, 161+）

### 外部API
- **Google Places API**: ジム検索（Hiveキャッシュ最適化）
- **Google Maps API**: 地図表示
- **Google Gemini 2.5 Flash**: AIコーチング（v1.0.157+）
- **RevenueCat**: iOS課金管理
- **Google AdMob**: 広告配信
- **connectivity_plus**: ネットワーク検出（^6.1.2、v1.0.180対応）

---

## 🎯 v1.03の技術的ハイライト

### 1. 腹筋トレーニング完全対応
- `is_time_mode` フラグで回数/秒数モード管理
- 既存データ（v1.0.169以前）の自動判定ロジック実装
- テーブルヘッダー動的化

### 2. 懸垂の体重2重加算バグ修正
- `additional_weight` フィールド導入
- 表示時のみ体重加算、保存時は追加重量のみ

### 3. オフライン記録機能
- Hiveローカルストレージ活用
- オンライン復帰時の自動同期
- `connectivity_plus` API変更対応（v1.0.180）

### 4. コスト最適化
- Google Maps API コスト削減（年間¥48,564/1000ユーザー）
- Hive永続キャッシュ（検索24h、詳細30d）

### 5. Firebase Analytics 実装
- ユーザー行動トラッキング
- スクリーン遷移分析
- パフォーマンスモニタリング

---

**© 2025 NEXA. All Rights Reserved.**
