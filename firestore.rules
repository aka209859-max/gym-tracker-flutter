rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // ğŸ”„ ã‚¢ãƒ—ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼ˆå…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèª­ã¿å–ã‚Šå¯èƒ½ï¼‰
    match /app_config/version_control {
      allow read: if true;  // å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèª­ã¿å–ã‚Šå¯èƒ½
      allow write: if false; // ç®¡ç†è€…ã®ã¿æ›¸ãè¾¼ã¿å¯èƒ½ï¼ˆFirebaseã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‹ã‚‰ï¼‰
    }
    
    // ğŸ”’ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆèªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // ğŸ“Š ãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¦ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆèªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
    match /workouts/{workoutId} {
      allow read, write: if request.auth != null;
    }
    
    // ğŸ‹ï¸ ã‚¸ãƒ æƒ…å ±ï¼ˆå…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèª­ã¿å–ã‚Šå¯èƒ½ï¼‰
    match /gyms/{gymId} {
      allow read: if true;
      allow write: if request.auth != null; // èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ›¸ãè¾¼ã¿å¯èƒ½
    }
    
    // ğŸ‘¥ æ··é›‘åº¦ãƒ¬ãƒãƒ¼ãƒˆï¼ˆèªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
    match /crowd_reports/{reportId} {
      allow read: if true;
      allow create: if request.auth != null;
      allow update, delete: if request.auth != null && request.auth.uid == resource.data.userId;
    }
    
    // ğŸ’° ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æƒ…å ±ï¼ˆæœ¬äººã®ã¿ï¼‰
    match /subscriptions/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // ğŸ ãƒªãƒ•ã‚¡ãƒ©ãƒ«æƒ…å ±ï¼ˆæœ¬äººã®ã¿ï¼‰
    match /referrals/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // ğŸ¯ AIä½¿ç”¨å±¥æ­´ï¼ˆæœ¬äººã®ã¿ï¼‰
    match /ai_usage/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ«ãƒ¼ãƒ«: ã™ã¹ã¦æ‹’å¦
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
