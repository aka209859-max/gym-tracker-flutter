# 🏋️ GYM MATCH v1.04 完全仕様書

**作成日**: 2025-12-20  
**対象バージョン**: v1.04 (v1.0.255+280)  
**App Store現行バージョン**: v1.03 (Build #217)  
**プラットフォーム**: iOS専用

---

## 📱 アプリケーション概要

**GYM MATCH（ジムマッチ）** は、全国のジム検索・混雑度表示・トレーニング記録を統合した、フィットネス総合支援アプリです。

### 基本情報
- **アプリ名**: GYM MATCH (gym_match)
- **技術スタック**: Flutter 3.35.4 + Dart 3.9.2
- **Firebase**: Firebase Core, Firestore, Auth, Storage, Analytics
- **地図統合**: Google Maps Flutter
- **課金システム**: RevenueCat + Apple In-App Purchase
- **広告システム**: Google AdMob

---

## 💰 料金プラン

### 🆓 無料プラン
**料金**: ¥0（永久無料）

**含まれる機能**:
- ✅ 全国のジム検索
- ✅ GPS位置検索
- ✅ 基本情報閲覧
- ✅ 混雑度表示
- ✅ 営業時間確認
- ✅ トレーニング記録（基本機能）
- ✅ 🤖 **AI機能 月3回**（AIコーチ・成長予測・効果分析の合計）
- ❌ 広告表示あり

**制限事項**:
- お気に入り保存: 不可
- レビュー投稿: 不可
- 詳細な混雑度統計: 不可
- パートナー検索: 不可
- メッセージング: 不可

---

### 💎 Premiumプラン
**料金**:
- **月額**: ¥500/月
- **年額**: ¥4,800/年（月換算 ¥400）← **20% OFF、年間¥1,200お得**

**無料トライアル**: 30日間無料

**含まれる機能**:
- ✨ **無料プランの全機能**
- ✅ 🤖 **AI機能 月20回**（AIコーチ・成長予測・効果分析の合計）
- ✅ ❤️ お気に入り無制限
- ✅ 📊 詳細な混雑度統計
- ✅ ⭐ ジムレビュー投稿
- ✅ 📈 成長予測と効果分析
- ✅ 🚫 **広告表示なし**

**制限事項**:
- パートナー検索: 不可
- メッセージング: 不可

---

### 🏆 Proプラン
**料金**:
- **月額**: ¥980/月
- **年額**: ¥8,000/年（月換算 ¥667）← **32% OFF、年間¥3,760お得**

**無料トライアル**: 14日間無料

**含まれる機能**:
- ✨ **Premiumプランの全機能**
- ✅ 🤖 **AI機能 無制限**（AIコーチ・成長予測・効果分析）
- ✅ 👥 **トレーニングパートナー検索**
  - 検索条件: 距離・目標・経験レベル・年齢・性別・希望曜日・希望時間帯でマッチング
- ✅ 💬 **メッセージング機能**（パートナーとチャット）

---

### 🌟 永年Proプラン（特別オファー）
**料金**: 買い切り（価格は非公開・キャンペーン時のみ）

**含まれる機能**:
- ✅ **Proプランの全機能を永久利用**
- ✅ AI機能無制限（永久）
- ✅ 広告表示なし（永久）
- ✅ すべての機能を永久利用

---

### 💊 AI追加パック（消耗型課金）
**対象**: 全プランのユーザー

**料金**: ¥300  
**内容**: AI機能使用回数を **+5回** 追加（今月のみ有効）

**用途**:
- AI使用回数の上限に達した場合
- プレミアムプランで月20回を超過した場合
- 無料プランで月3回を超過した場合

---

## 🎯 機能一覧

### 1. ジム検索機能（全ユーザー利用可能）

#### 1.1 地図検索
- **画面**: `map_screen.dart`
- **機能**: Google Maps統合によるジム検索
- リアルタイムGPS位置検索
- 地図上にジムをマーカー表示
- 現在地からの距離表示
- ジムタップで詳細情報表示

#### 1.2 リスト検索
- **画面**: `gym_list_screen.dart`
- **機能**: ジムの一覧表示
- 距離順・評価順でソート
- フィルター機能（営業中のみ表示など）
- お気に入りマーク（有料プラン限定）

#### 1.3 検索画面
- **画面**: `search_screen.dart`
- **機能**: キーワード検索
- エリア名・ジム名で検索
- 検索履歴保存
- 検索候補表示

#### 1.4 ジム詳細情報
- **画面**: `gym_detail_screen.dart`
- **表示情報**:
  - ジム名・住所・電話番号
  - 営業時間
  - 設備情報
  - 写真ギャラリー
  - レビュー閲覧
  - 混雑度表示（リアルタイム）
  - ルート案内（Google Maps連携）

---

### 2. 混雑度表示機能（全ユーザー利用可能）

#### 2.1 リアルタイム混雑度
- **画面**: `gym_detail_screen.dart`
- **機能**:
  - 現在の混雑度をグラフ表示
  - ユーザー投稿レポートによる混雑度更新
  - 混雑レベル: 空いている・普通・混雑・非常に混雑
  - 最終更新日時表示

#### 2.2 混雑度レポート投稿
- **画面**: `crowd_report_screen.dart`
- **機能**:
  - 現在の混雑度を投稿
  - 5段階評価（1: 空いている ～ 5: 非常に混雑）
  - コメント投稿可能
  - 投稿者には貢献ポイント付与

#### 2.3 混雑度統計（有料プラン限定）
- **機能**:
  - 曜日別・時間帯別の混雑度予測
  - 過去データに基づく統計グラフ
  - 最適な訪問時間帯の提案

---

### 3. トレーニング記録機能（全ユーザー利用可能）

#### 3.1 ホーム画面
- **画面**: `home_screen.dart`
- **機能**:
  - トレーニングカレンダー表示
  - 今日のトレーニング状況
  - 週次・月次統計サマリー
  - 直近のトレーニング履歴
  - クイックアクセスボタン

#### 3.2 トレーニング記録追加
- **画面**: `workout/add_workout_screen.dart`
- **機能**:
  - 種目選択（筋トレ・有酸素運動）
  - セット数・レップ数・重量入力
  - 有酸素運動: 時間・距離入力
  - 部位選択（胸・背中・脚・肩・腕・腹・有酸素）
  - メモ入力
  - 写真添付（ビフォーアフター）
  - CSV一括インポート

#### 3.3 トレーニング履歴
- **画面**: `workout/workout_log_screen.dart`, `workout/workout_history_screen.dart`
- **機能**:
  - 過去のトレーニング記録一覧
  - 日付別・部位別フィルター
  - 筋トレ/有酸素の2部屋フィルター
  - 詳細表示・編集・削除
  - トレーニングメモ表示

#### 3.4 部位別トラッキング
- **画面**: `workout/body_part_tracking_screen.dart`
- **機能**:
  - 身体部位ごとのトレーニング頻度
  - 部位別の総重量・総レップ数
  - 視覚的なボディマップ表示
  - 偏りの警告表示

#### 3.5 自己ベスト（PR）記録
- **画面**: `workout/personal_records_screen.dart`
- **機能**:
  - 種目別の最高重量記録
  - 部位別PR一覧
  - PR達成日・期間表示
  - 不完全なセットも含めてPR判定
  - 全身体部位を常に表示

#### 3.6 週次レポート
- **画面**: `workout/weekly_reports_screen.dart`
- **機能**:
  - 週ごとのトレーニング統計
  - 総重量・総レップ数・総セット数
  - 部位別の訓練バランス
  - 前週との比較

#### 3.7 RM計算機
- **画面**: `workout/rm_calculator_screen.dart`
- **機能**:
  - 1RM（最大挙上重量）計算
  - 各%RMの重量予測
  - トレーニング強度設定の補助

#### 3.8 統計ダッシュボード
- **画面**: `workout/statistics_dashboard_screen.dart`
- **機能**:
  - 総合トレーニング統計
  - グラフによる視覚化
  - 成長曲線表示
  - 目標達成率

#### 3.9 トレーニングテンプレート
- **画面**: `workout/template_screen.dart`, `workout/create_template_screen.dart`
- **機能**:
  - よく行うメニューをテンプレート保存
  - ワンタップでトレーニング開始
  - テンプレート編集・削除

#### 3.10 トレーニングメモ
- **画面**: `workout/workout_memo_list_screen.dart`
- **機能**:
  - トレーニングごとのメモ一覧
  - フォームのコツ・感想記録
  - トレーナーからのアドバイス保存

---

### 4. 🤖 AIコーチ機能（利用回数制限あり）

#### 4.1 AIトレーニングアドバイス
- **画面**: `workout/ai_coaching_screen.dart`, `workout/ai_coaching_screen_tabbed.dart`
- **機能**:
  - 個別のトレーニングプラン提案
  - フォームアドバイス
  - 休息日の提案
  - 種目選択のアドバイス
  - 過去の記録に基づくパーソナライズ

#### 4.2 成長予測（有料プラン限定）
- **機能**:
  - 今後の筋力成長予測
  - 目標達成までの期間予測
  - 最適なトレーニング頻度提案

#### 4.3 効果分析（有料プラン限定）
- **機能**:
  - 現在のトレーニングの効果分析
  - 改善ポイントの提示
  - ボトルネックの特定
  - プラトー打破の提案

**AI利用回数**:
- 無料プラン: 月3回
- Premiumプラン: 月20回
- Proプラン: 無制限
- 追加購入: ¥300で+5回

---

### 5. お気に入り・ブックマーク機能（有料プラン限定）

#### 5.1 お気に入りジム
- **画面**: `favorites_screen.dart`
- **機能**:
  - よく行くジムを登録
  - お気に入り一覧表示
  - ワンタップでジム詳細へ
  - お気に入りの混雑度通知

---

### 6. レビュー投稿機能（有料プラン限定）

#### 6.1 ジムレビュー
- **画面**: `gym_review_screen.dart`
- **機能**:
  - 5段階評価
  - コメント投稿
  - 写真投稿
  - 設備・清潔さ・スタッフ対応を個別評価

---

### 7. 👥 トレーニングパートナー検索（Proプラン限定）

#### 7.1 パートナー検索
- **画面**: `partner/partner_search_screen.dart`, `partner/partner_search_screen_new.dart`
- **検索条件**:
  - 距離（半径指定）
  - トレーニング目標（筋肥大・ダイエット・健康維持など）
  - 経験レベル（初心者・中級者・上級者）
  - 年齢範囲
  - 性別
  - 希望曜日
  - 希望時間帯

#### 7.2 パートナー詳細
- **画面**: `partner/partner_detail_screen.dart`, `partner/partner_profile_detail_screen.dart`
- **表示情報**:
  - プロフィール情報
  - トレーニング履歴
  - 目標・経験レベル
  - よく行くジム
  - 自己紹介

#### 7.3 パートナープロフィール編集
- **画面**: `partner/partner_profile_edit_screen.dart`
- **機能**:
  - プロフィール写真設定
  - 自己紹介文編集
  - トレーニング目標設定
  - 希望条件設定

#### 7.4 パートナーリクエスト
- **画面**: `partner/partner_requests_screen.dart`
- **機能**:
  - パートナー申請送信
  - 受信した申請の承認/拒否
  - リクエスト一覧表示

#### 7.5 マイパートナー
- **画面**: `partner/partner_screen.dart`
- **機能**:
  - 承認済みパートナー一覧
  - パートナーとのトレーニング記録共有
  - モチベーション共有

---

### 8. 💬 メッセージング機能（Proプラン限定）

#### 8.1 チャット一覧
- **画面**: `messages/messages_screen.dart`, `messaging_screen.dart`
- **機能**:
  - パートナーとのチャットルーム一覧
  - 未読メッセージ表示
  - 最新メッセージプレビュー

#### 8.2 チャット詳細
- **画面**: `messages/chat_detail_screen.dart`, `chat_screen.dart`, `partner/chat_screen_partner.dart`
- **機能**:
  - リアルタイムメッセージ送受信
  - テキストメッセージ
  - トレーニング記録の共有
  - 画像送信

---

### 9. プロフィール・設定機能

#### 9.1 プロフィール画面
- **画面**: `profile_screen.dart`
- **表示情報**:
  - ユーザー名・プロフィール写真
  - 現在のプラン表示
  - トレーニング統計サマリー
  - 達成バッジ
  - 設定メニュー

#### 9.2 プロフィール編集
- **画面**: `profile_edit_screen.dart`
- **編集項目**:
  - プロフィール写真
  - ユーザー名
  - 身長・体重・年齢
  - トレーニング目標
  - 自己紹介

#### 9.3 サブスクリプション管理
- **画面**: `subscription_screen.dart`
- **機能**:
  - 現在のプラン確認
  - プランアップグレード/ダウングレード
  - 無料トライアル開始
  - 購入復元（Restore）
  - AI追加パック購入
  - 解約案内（App Store設定へ誘導）

#### 9.4 通知設定
- **画面**: `settings/notification_settings_screen.dart`
- **設定項目**:
  - トレーニングリマインダー
  - 混雑度通知
  - パートナーメッセージ通知
  - プロモーション通知

#### 9.5 トライアル進捗
- **画面**: `settings/trial_progress_screen.dart`
- **機能**:
  - 無料トライアル残日数表示
  - トライアル終了日
  - 自動更新の案内

---

### 10. 身体測定・目標管理

#### 10.1 身体測定記録
- **画面**: `body_measurement_screen.dart`
- **記録項目**:
  - 体重
  - 体脂肪率
  - 各部位のサイズ（胸囲・腕囲・ウエスト・太もも）
  - 記録日時
  - グラフ表示

#### 10.2 目標設定
- **画面**: `goals_screen.dart`
- **機能**:
  - 体重目標
  - 筋力目標（種目別）
  - 期限設定
  - 達成率表示

#### 10.3 達成バッジ
- **画面**: `achievements_screen.dart`
- **機能**:
  - トレーニング達成バッジ
  - 継続日数バッジ
  - PR達成バッジ
  - 特別イベントバッジ

---

### 11. 疲労管理・体調管理

#### 11.1 疲労管理
- **画面**: `fatigue_management_screen.dart`
- **機能**:
  - 日々の体調記録
  - 疲労度チェック
  - 休息日推奨アラート
  - 睡眠時間記録

#### 11.2 個人要因記録
- **画面**: `personal_factors_screen.dart`
- **機能**:
  - 体調に影響する要因記録
  - ストレスレベル
  - 睡眠の質
  - 食事の質

---

### 12. 計算ツール

#### 12.1 各種計算機
- **画面**: `calculators_screen.dart`
- **搭載ツール**:
  - BMI計算機
  - TDEE（総消費カロリー）計算
  - マクロ栄養素計算
  - 体脂肪率計算
  - RM計算機へのリンク

---

### 13. パーソナルトレーニング予約機能

#### 13.1 PT予約
- **画面**: `personal_training_screen.dart`, `reservation_form_screen.dart`
- **機能**:
  - トレーナー一覧表示
  - トレーナー詳細情報
  - 空き枠確認
  - 予約申し込み
  - 予約履歴

#### 13.2 トレーナー記録（トレーナー側機能）
- **画面**: `personal_training/trainer_records_screen.dart`
- **機能**:
  - クライアントのトレーニング記録
  - セッション記録
  - クライアント管理

---

### 14. パートナージム管理機能（ジムオーナー向け）

#### 14.1 PO（Partner Owner）ログイン
- **画面**: `po/po_login_screen.dart`
- **機能**: パートナージム専用ログイン

#### 14.2 POダッシュボード
- **画面**: `po/po_dashboard_screen.dart`
- **表示情報**:
  - 今日の訪問者数
  - 混雑度統計
  - レビュー一覧
  - 売上サマリー

#### 14.3 会員管理
- **画面**: `po/po_members_screen.dart`, `po/po_member_detail_screen.dart`
- **機能**:
  - 会員一覧
  - 会員詳細情報
  - トレーニング履歴閲覧
  - メモ管理

#### 14.4 セッション管理
- **画面**: `po/po_sessions_screen.dart`
- **機能**:
  - PT予約一覧
  - セッションスケジュール
  - トレーナー割り当て

#### 14.5 設備管理
- **画面**: `po/gym_equipment_editor_screen.dart`, `partner_equipment_editor_screen.dart`
- **機能**:
  - 設備情報編集
  - 器具一覧管理
  - メンテナンス記録

#### 14.6 お知らせ管理
- **画面**: `po/gym_announcement_editor_screen.dart`
- **機能**:
  - ジムからのお知らせ作成
  - 会員へのプッシュ通知
  - イベント告知

#### 14.7 写真管理
- **画面**: `partner_photos_screen.dart`
- **機能**:
  - ジム内写真アップロード
  - ギャラリー編集
  - 写真の並び替え

#### 14.8 キャンペーン管理
- **画面**: `partner_campaign_editor_screen.dart`
- **機能**:
  - キャンペーン作成・編集
  - 割引設定
  - 期間限定オファー

#### 14.9 予約設定
- **画面**: `partner_reservation_settings_screen.dart`
- **機能**:
  - 予約受付時間設定
  - 定員設定
  - キャンセルポリシー設定

#### 14.10 分析画面
- **画面**: `po/po_analytics_screen.dart`
- **機能**:
  - 訪問者数推移
  - 混雑度データ分析
  - 人気時間帯分析
  - 収益分析

---

### 15. キャンペーン・紹介機能

#### 15.1 キャンペーン登録
- **画面**: `campaign/campaign_registration_screen.dart`
- **機能**:
  - 特別キャンペーンへの応募
  - 紹介コード入力
  - 特典獲得

#### 15.2 SNSシェア
- **画面**: `campaign/campaign_sns_share_screen.dart`
- **機能**:
  - トレーニング記録をSNSシェア
  - PR達成をシェア
  - 招待リンク生成
  - スクリーンショット自動生成

#### 15.3 招待コード
- **画面**: `redeem_invite_code_screen.dart`
- **機能**:
  - 友達招待コード入力
  - 特典獲得（招待者・被招待者双方）
  - 招待履歴

---

### 16. 訪問履歴・チェックイン

#### 16.1 訪問履歴
- **画面**: `visit_history_screen.dart`
- **機能**:
  - ジム訪問履歴
  - 訪問回数統計
  - よく行くジムランキング
  - 訪問日記録

---

### 17. オンボーディング・初回案内

#### 17.1 初回起動時のチュートリアル
- **画面**: `onboarding_screen.dart`, `onboarding/onboarding_screen.dart`
- **機能**:
  - アプリ機能の説明
  - 基本的な使い方ガイド
  - 権限リクエスト（位置情報・通知）

---

### 18. 認証・セキュリティ

#### 18.1 ログイン・サインアップ
- **画面**: `auth_screen.dart`
- **機能**:
  - メールアドレス認証
  - 匿名認証
  - ソーシャルログイン（Google/Apple）

#### 18.2 パスワードゲート
- **画面**: `password_gate_screen.dart`, `personal_training/pt_password_screen.dart`
- **機能**:
  - 管理画面へのアクセス制限
  - パスワード認証

---

### 19. 管理者・開発者機能

#### 19.1 開発者メニュー
- **画面**: `developer_menu_screen.dart`
- **機能** (デバッグビルドのみ):
  - Firebase接続テスト
  - ログ確認
  - キャッシュクリア
  - プラン変更テスト

#### 19.2 デバッグログ
- **画面**: `debug_log_screen.dart`
- **機能**:
  - アプリ内ログ閲覧
  - エラーログ確認
  - API通信ログ

#### 19.3 Phase移行画面
- **画面**: `admin/phase_migration_screen.dart`
- **機能**:
  - データマイグレーション管理
  - バージョンアップデート処理

---

## 📊 機能比較表

| 機能カテゴリ | 無料 | Premium | Pro |
|------------|------|---------|-----|
| **ジム検索** | ✅ | ✅ | ✅ |
| **GPS位置検索** | ✅ | ✅ | ✅ |
| **混雑度表示** | ✅ | ✅ | ✅ |
| **トレーニング記録** | ✅ | ✅ | ✅ |
| **AI機能** | 月3回 | 月20回 | 無制限 |
| **広告表示なし** | ❌ | ✅ | ✅ |
| **お気に入り保存** | ❌ | ✅ | ✅ |
| **レビュー投稿** | ❌ | ✅ | ✅ |
| **詳細混雑度統計** | ❌ | ✅ | ✅ |
| **成長予測・効果分析** | ❌ | ✅ | ✅ |
| **パートナー検索** | ❌ | ❌ | ✅ |
| **メッセージング** | ❌ | ❌ | ✅ |

---

## 🔧 技術仕様

### Firebase統合
- **firebase_core**: 3.6.0
- **cloud_firestore**: 5.4.3
- **firebase_auth**: 5.3.1
- **firebase_storage**: 12.3.2
- **firebase_analytics**: 11.3.3

### Google Maps統合
- **google_maps_flutter**: 2.10.0
- **google_maps_flutter_web**: 0.5.10
- **geolocator**: 13.0.2
- **geocoding**: 3.0.0

### 課金システム
- **purchases_flutter**: 8.11.0（RevenueCat SDK）
- **app_tracking_transparency**: 2.0.6（ATT対応）

### 広告システム
- **google_mobile_ads**: 5.3.1（AdMob）

### その他主要パッケージ
- **provider**: 6.1.5+1（状態管理）
- **shared_preferences**: 2.5.3（ローカルストレージ）
- **hive**: 2.2.3（ローカルDB）
- **fl_chart**: 0.69.0（グラフ表示）
- **table_calendar**: 3.1.2（カレンダー表示）
- **screenshot**: 3.0.0（SNSシェア用画像生成）
- **share_plus**: 10.1.3（SNS共有）
- **in_app_review**: 2.0.10（App Storeレビュー依頼）

---

## 📱 対応プラットフォーム

- ✅ **iOS**: iOS 12.0以降（主要プラットフォーム）
- ✅ **Web**: プレビュー・開発用（機能制限あり）
- ❌ **Android**: 別リポジトリ管理（本リポジトリには含まれません）

---

## 🎯 マネタイズ戦略

### 収益源
1. **サブスクリプション収入**（メイン収益）
   - Premiumプラン: ¥500/月 or ¥4,800/年
   - Proプラン: ¥980/月 or ¥8,000/年
   - 永年Proプラン: 買い切り

2. **AI追加パック**（補助収益）
   - ¥300/個（5回分）

3. **広告収入**（無料プランユーザー）
   - AdMobバナー広告
   - インタースティシャル広告
   - リワード広告

### フリーミアム戦略
- 無料プランで基本機能を提供し、ユーザーを獲得
- AI機能（月3回）で価値を体験させる
- 有料プランへのアップグレードを促進
- 無料トライアル（Premium: 30日、Pro: 14日）で転換率向上

---

## 📈 今後の開発予定（v1.05以降）

### 予定機能
- プッシュ通知の強化
- オフライン対応の改善
- AIコーチ機能の高度化
- ソーシャル機能の拡充
- Apple Watch連携

---

## 📝 利用規約・法的事項

- **利用規約**: `settings/terms_of_service_screen.dart`
- **プライバシーポリシー**: Firebase Hosting上で公開
- **特定商取引法に基づく表記**: `settings/tokutei_shoutorihikihou_screen.dart`

---

## 🔐 プライバシー・セキュリティ

- Firebase Authenticationによる安全な認証
- 個人情報のFirestore暗号化保存
- Apple App Tracking Transparency（ATT）完全対応
- GDPR・プライバシー法令遵守

---

## 📞 サポート・問い合わせ

アプリ内の「プロフィール」→「設定」→「ヘルプ・お問い合わせ」よりご連絡ください。

---

**最終更新**: 2025-12-20  
**ドキュメントバージョン**: v1.04 (Build #280)  
**作成者**: GYM MATCH開発チーム

---

_このドキュメントは、実際のソースコードから抽出した情報に基づいて作成されています。ハルシネーションは含まれません。_
